#####Trimming, deduplicating, and quality filtering fastq files

#Upload script
trim_mdRAD_2frags.pl

#get permission for scripts
chmod 777 trim_mdRAD_2frags.pl

# gunzip all fastq
# trim_mdRAD.pl all fastq (demultiplex)

# example
gunzip illUN-4-51_S28_L001_R1_001.fastq.gz
gunzip illUN-4-51_S28_L002_R1_001.fastq.gz

trim_mdRAD.pl input=illUN-4-51_S28_L001_R1_001.fastq sampleID=3
trim_mdRAD.pl input=illUN-4-51_S28_L002_R1_001.fastq sampleID=3


# for reference-based analysis: trimming poor quality bases off ends:
>trimse2
for file in *.tr0; do echo "cutadapt -q 15,15 -m 25 -o ${file/.tr0/}.trim $file > ${file}_trimlog.txt" >> trimse2; done
         #this creates a file called trimse-open up the file to see all the commands to use cutadapt for each file.

# execute all commands in trimse file (serial or parallel using Launcher, if your system allows) 

#once the job is finished, merge together all log files created from trimming so that they are easier to look at
cat *.txt > Merged_trimlog_files.txt 

#all trimmed files have ending, .trim

#check to see of you have the right amount of trim files (should match the number of .tr0 files)
ls -l *.trim | wc -l

